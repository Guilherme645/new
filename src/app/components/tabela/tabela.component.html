<div class="table-wrapper">
  <div class="container">
    <table class="table">
      <!-- Cabeçalhos da tabela -->
      <thead>
  <tr>
    <th class="menu-lateral">
      <div class="linha"></div>
    </th>
    <th class="coluna descricao" (click)="sortBy('name')">
      <div class="titulo flex items-center gap-1 text-xs font-semibold text-gray-600 cursor-pointer">
        {{ type === 'project' ? 'NOME DO PROJETO' : 'NOME DA COLEÇÃO' }}
        <div class="icon-wrapper-one">
          <div class="relative group flex items-center justify-center w-8 h-8">
  <!-- Ícone -->
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    class="cursor-pointer"
  >
    <path
      d="M7.33301 10.6666L5.33301 12.6666M5.33301 12.6666L3.33301 10.6666M5.33301 12.6666V3.33325M8.66634 5.33325L10.6663 3.33325M10.6663 3.33325L12.6663 5.33325M10.6663 3.33325V12.6666"
      stroke="#535862"
      stroke-linecap="round"
      stroke-linejoin="round"
    />
  </svg>

<!-- Tooltip -->
 <div class="absolute top-0 left-[-10px] -translate-x-1/2 mt-8 opacity-0 group-hover:opacity-100 transition-opacity">
    <app-tooltip text="Ordenação"></app-tooltip>
  </div>
</div>
        </div>
      </div>
    </th>
    <th class="coluna descricao" (click)="sortBy('description')">
      <div class="titulo flex items-center gap-1 text-xs font-semibold text-gray-600 cursor-pointer">
        DESCRIÇÃO
        <div class="icon-wrapper-two">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.33301 10.6666L5.33301 12.6666M5.33301 12.6666L3.33301 10.6666M5.33301 12.6666V3.33325M8.66634 5.33325L10.6663 3.33325M10.6663 3.33325L12.6663 5.33325M10.6663 3.33325V12.6666"
                  stroke="#535862" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
      </div>
    </th>
          <th class="coluna indexacao">
            <div class="titulo flex justify-between mr-[52px]">
              <span>INDEXAÇÃO</span>
         <div class="dropdown custom-margin-right">
  <app-dropdown></app-dropdown>
</div>
              
            </div>
          </th>
          <th class="icones-finais"></th>
        </tr>
      </thead>

      <!-- Corpo da tabela -->
      <tbody>
        <ng-container *ngFor="let item of data; let i = index">
          <!-- Linha principal do item -->
          <tr>
          <td class="menu-lateral">
  <div class="item cursor-pointer" *ngIf="type === 'project'" (click)="toggleItem(i)">
    <!-- Ícone seta para expandir -->
    <svg class="shrink-0 transition-transform duration-200"
         [ngClass]="{ 'rotate-90': item.expanded }"
         width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9 1L5 5L1 1" stroke="#717680" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>

  <!-- Container com controle de hover -->
<div class="relative group inline-block">
  <!-- Ícone pasta -->
  <svg
    class="shrink-0 cursor-pointer"
    width="34"
    height="26"
    viewBox="0 0 34 26"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M33 7.5V23C33 24.1046 32.1046 25 31 25H3C1.89543 25 1 24.1046 1 23V3C1 1.89543 1.89543 1 3 1H11.1817C11.7062 1 12.2096 1.20597 12.5836 1.57354L15.9953 4.92646C16.3694 5.29403 16.8728 5.5 17.3972 5.5H31C32.1046 5.5 33 6.39543 33 7.5Z"
      fill="#D6DBF7"
      stroke="#ADB7F0"
      stroke-width="0.8"
    />
  </svg>

  <!-- Tooltip -->
  <div class="absolute top-0 left-[52px] -translate-x-1/2 mt-8 opacity-0 group-hover:opacity-100 transition-opacity">
    <app-tooltip text="Ver coleções do projeto"></app-tooltip>
  </div>
</div>

  </div>

  <!-- Espaço em branco para alinhar visualmente com projetos -->
  <div *ngIf="type === 'collection'" class="w-[34px] h-[26px]"></div>
</td>
            <td class="coluna descricao">
              <div class="linha-texto">{{ item.name || item.title }}</div>
            </td>
            <td class="coluna descricao">
              <div class="linha-texto">{{ item.description }}</div>
            </td>
            <td class="coluna indexacao">
              <app-progress-bar [state]="item.progressState" [percent]="item.progressPercent"></app-progress-bar>
            </td>
          <td class="icones-finais relative">
  <div class="inline-block group">
    <!-- Botão de opções -->
    <button (click)="toggleDropdown(i)" class="icone-horizontal">
      <svg width="16" height="4" viewBox="0 0 16 4" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M13 2C13 2.55228 13.4477 3 14 3C14.5523 3 15 2.55228 15 2C15 1.44772 14.5523 1 14 1C13.4477 1 13 1.44772 13 2Z" stroke="#717680" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M7 2C7 2.55228 7.44772 3 8 3C8.55228 3 9 2.55228 9 2C9 1.44772 8.55228 1 8 1C7.44772 1 7 1.44772 7 2Z" stroke="#717680" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M1 2C1 2.55228 1.44772 3 2 3C2.55228 3 3 2.55228 3 2C3 1.44772 2.55228 1 2 1C1.44772 1 1 1.44772 1 2Z" stroke="#717680" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <!-- Tooltip visível apenas com hover -->
    <div
      class="absolute bottom-full left-[-15px] -translate-x-1/2 mb-1 opacity-0 group-hover:opacity-100 transition-opacity z-50"
    >
      <app-tooltip text="Mais opções"></app-tooltip>
    </div>

    <!-- Dropdown -->
    <app-option-dropdown
        *ngIf="dropdownIndex === i"
      class="absolute mt-2 z-100"
      (edit)="handleEdit()"
      (duplicate)="handleDuplicate()"
      (remove)="handleRemove()"
    ></app-option-dropdown>
  </div>
</td>


          </tr>

          <!-- Linha de expansão -->
         <tr *ngIf="item.expanded" class="expanded-tr">
  <td colspan="5" class="expanded-row">
    <div class="expanded-content">
      <div class="collection-scroll-wrapper">
        <app-collection-tree [data]="item.subcollections || []"></app-collection-tree>
      </div>
    </div>
  </td>
</tr>

        </ng-container>
      </tbody>
    </table>
  </div>
</div>

<!-- Paginação -->
<footer class="pagination-container">
  <div class="pagination-text">
    Exibindo {{ data.length }} de {{ totalItems }} {{ type === 'project' ? 'projetos' : 'coleções' }}
  </div>
  <div class="pagination-controls">
    <ng-container *ngIf="currentPage > 1; else leftSpacer">
      <button class="pagination-button" (click)="previousPage()">
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9.33333 11.6271L6.66666 8.96043L9.33333 6.29376" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </ng-container>
    <ng-template #leftSpacer>
      <div style="width: 16px; height: 17px;"></div>
    </ng-template>
    <div class="pagination-status">
      <div class="pagination-box">
        <div class="pagination-current">{{ currentPage }}</div>
      </div>
      <span class="pagination-pages">de {{ totalPages }} páginas</span>
    </div>
    <ng-container *ngIf="currentPage < totalPages; else rightSpacer">
      <button class="pagination-button" (click)="nextPage()">
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.66667 6.29376L9.33334 8.96043L6.66667 11.6271" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </ng-container>
    <ng-template #rightSpacer>
      <div style="width: 16px; height: 17px;"></div>
    </ng-template>
  </div>
</footer>