<div class="flex flex-row items-start w-full h-[calc(100vh-200px)] bg-white border border-gray-100 rounded-lg overflow-y-auto overflow-x-hidden box-border">
  <div class="flex flex-col w-full mx-auto">
    <table class="w-full border-collapse bg-white relative">
      <thead class="sticky top-0 bg-white z-10 border-b border-gray-200">
        <tr>
          <th class="w-[91px] p-2 text-center align-middle">
            <div class="h-[26px]"></div>
          </th>
          <th class="p-2 align-middle w-[400px] break-words">
            <div
              class="flex items-center gap-1 text-xs font-semibold text-gray-600 cursor-pointer"
              (click)="sortBy('name')"
            >
              {{ type === 'project' ? 'NOME DO PROJETO' : 'NOME DA COLEÇÃO' }}
              <div class="ml-[119px]">
                <div
                  class="relative group flex items-center justify-center w-6 h-6 rounded-[4px] shadow-sm transition-all"
                  [ngClass]="{
                    'bg-white border border-[#E9EAEB]': sortField !== 'name',
                    'bg-[#D6DBF7] border border-[#314CD9]': sortField === 'name'
                  }"
                >
                  <ng-container *ngIf="sortField !== 'name'; else activeSort">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path
                        d="M7.33301 10.6666L5.33301 12.6666M5.33301 12.6666L3.33301 10.6666M5.33301 12.6666V3.33325M8.66634 5.33325L10.6663 3.33325M10.6663 3.33325L12.6663 5.33325M10.6663 3.33325V12.6666"
                        stroke="#535862"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </ng-container>

                  <ng-template #activeSort>
                    <ng-container *ngIf="sortDirection === 'asc'; else descIcon">
                      <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path
                          d="M2.66663 11.3334H10.6666M2.66663 8.00004H8.66663M2.66663 4.66671H6.66663M12 8.66671V3.33337M12 3.33337L14 5.33337M12 3.33337L9.99996 5.33337"
                          stroke="#314CD9"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </ng-container>

                    <ng-template #descIcon>
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M2.66663 11.3334H6.66663M2.66663 8.00002H8.66663M12 7.33335V12.6667M12 12.6667L14 10.6667M12 12.6667L9.99996 10.6667M2.66663 4.66669H10.6666"
                          stroke="#314CD9"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </ng-template>
                  </ng-template>

                  <span
                    class="tooltip-order absolute top-full left-1/2 transform -translate-x-1/2 mt-1 px-2 py-1 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity"
                  >
                    Ordenação
                  </span>
                </div>
              </div>
            </div>
          </th>

          <th class="p-0 align-middle w-[410px] break-words">
            <div
              class="flex items-center gap-1 text-xs font-semibold text-gray-600 cursor-pointer"
              (click)="sortBy('description')"
            >
              DESCRIÇÃO DO PROJETO
              <div class="ml-[82px]">
                <div
                  class="relative group flex items-center justify-center w-6 h-6 rounded-[4px] shadow-sm transition-all"
                  [ngClass]="{
                    'bg-white border border-[#E9EAEB]': sortField !== 'description',
                    'bg-[#D6DBF7] border border-[#314CD9]': sortField === 'description'
                  }"
                >
                  <ng-container *ngIf="sortField !== 'description'; else activeSortDesc">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path
                        d="M7.33337 10.6666L5.33337 12.6666M5.33337 12.6666L3.33337 10.6666M5.33337 12.6666V3.33325M8.66671 5.33325L10.6667 3.33325M10.6667 3.33325L12.6667 5.33325M10.6667 3.33325V12.6666"
                        stroke="#535862"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </ng-container>

                  <ng-template #activeSortDesc>
                    <ng-container *ngIf="sortDirection === 'asc'; else descIcon">
                      <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path
                          d="M2.66663 11.3334H10.6666M2.66663 8.00004H8.66663M2.66663 4.66671H6.66663M12 8.66671V3.33337M12 3.33337L14 5.33337M12 3.33337L9.99996 5.33337"
                          stroke="#314CD9"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </ng-container>

                    <ng-template #descIcon>
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M2.66663 11.3334H6.66663M2.66663 8.00002H8.66663M12 7.33335V12.6667M12 12.6667L14 10.6667M12 12.6667L9.99996 10.6667M2.66663 4.66669H10.6666"
                          stroke="#314CD9"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </ng-template>
                  </ng-template>

                  <span
                    class="tooltip-order absolute top-full left-1/2 transform -translate-x-1/2 mt-1 px-2 py-1 text-xs text-white bg-black rounded opacity-0 group-hover:opacity-100 transition-opacity"
                  >
                    Ordenação
                  </span>
                </div>
              </div>
            </div>
          </th>

          <th class="p-2 align-middle max-w-[401px] break-words">
            <div class="flex items-center gap-1 ml-[22px] text-xs font-semibold text-gray-600 cursor-pointer">
              INDEXAÇÃO
              <div class="ml-[205px]">
                <app-dropdown></app-dropdown>
              </div>
            </div>
          </th>
          <th class="w-[47px] p-0 text-center align-middle"></th>
        </tr>
      </thead>
      <tbody class="relative">
        <ng-container *ngFor="let item of data; let i = index">
          <tr>
            <td class="p-2 text-center align-middle">
              <div *ngIf="type === 'project'" class="flex items-center gap-2 justify-center cursor-pointer" (click)="toggleItem(i)">
                <svg
                  class="shrink-0 transition-transform duration-200"
                  [ngClass]="{ 'rotate-180': item.expanded }"
                  width="10"
                  height="6"
                  viewBox="0 0 10 6"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M9 1L5 5L1 1" stroke="#717680" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <div class="relative group inline-block">
                  <svg
                    class="shrink-0 cursor-pointer"
                    width="34"
                    height="26"
                    viewBox="0 0 34 26"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M33 7.5V23C33 24.1046 32.1046 25 31 25H3C1.89543 25 1 24.1046 1 23V3C1 1.89543 1.89543 1 3 1H11.1817C11.7062 1 12.2096 1.20597 12.5836 1.57354L15.9953 4.92646C16.3694 5.29403 16.8728 5.5 17.3972 5.5H31C32.1046 5.5 33 6.39543 33 7.5Z"
                      fill="#D6DBF7"
                      stroke="#ADB7F0"
                      stroke-width="0.8"
                    />
                  </svg>
                  <div class="absolute top-0 left-[52px] -translate-x-1/2 mt-8 opacity-0 group-hover:opacity-100 transition-opacity">
                    <app-tooltip text="Ver coleções do projeto"></app-tooltip>
                  </div>
                </div>
              </div>
              <div *ngIf="type === 'collection'" class="w-[34px] h-[26px]"></div>
            </td>
            <td class="p-2 align-middle max-w-[300px] break-words">
              <div class="text-sm text-gray-900 py-2">{{ item.name || item.title }}</div>
            </td>
            <td class="w-[313px] text-left px-2 py-3 text-sm text-gray-900 align-middle box-border">
              <div class="text-sm text-gray-900 py-2">{{ item.description }}</div>
            </td>
            <td class="p-2 align-middle max-w-[401px] break-words">
              <app-progress-bar
                [state]="item.progressState ?? 'default'"
                [percent]="item.progressPercent ?? 0"
                (openRemoveProject)="emitOpenRemoveProject()"
              ></app-progress-bar>
            </td>
            <td class="p-0 text-center align-middle relative">
              <div class="inline-block group">
                <button (click)="toggleDropdown(i)" class="h-[26px] mt-5 cursor-pointer">
                  <svg width="16" height="4" viewBox="0 0 16 4" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M13 2C13 2.55228 13.4477 3 14 3C14.5523 3 15 2.55228 15 2C15 1.44772 14.5523 1 14 1C13.4477 1 13 1.44772 13 2Z"
                      stroke="#717680"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M7 2C7 2.55228 7.44772 3 8 3C8.55228 3 9 2.55228 9 2C9 1.44772 8.55228 1 8 1C7.44772 1 7 1.44772 7 2Z"
                      stroke="#717680"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M1 2C1 2.55228 1.44772 3 2 3C2.55228 3 3 2.55228 3 2C3 1.44772 2.55228 1 2 1C1.44772 1 1 1.44772 1 2Z"
                      stroke="#717680"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </button>
                <div
                  class="absolute bottom-full left-[-25px] mt-[-5px] -translate-x-1/2 mb-1 opacity-0 group-hover:opacity-100 transition-opacity z-50"
                >
                  <app-tooltip text="Mais opções"></app-tooltip>
                </div>
                <app-option-dropdown
                  *ngIf="dropdownIndex === i"
                  class="absolute mt-2 z-[9999] bg-white shadow-lg rounded-md min-w-[180px]"
                  (edit)="handleEdit()"
                  (duplicate)="handleDuplicate()"
                  (remove)="handleRemove()"
                  (openRemove)="emitOpenRemove()"
                ></app-option-dropdown>
              </div>
            </td>
          </tr>
          <tr *ngIf="item.expanded && type === 'project'" class="bg-gray-50">
            <td colspan="5" class="p-0">
              <div class="block w-full h-auto box-border overflow-hidden">
                <div class="overflow-x-hidden">
                  <app-collection-tree [data]="item.subcollections ?? []"></app-collection-tree>
                </div>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>

<div
  class="mt-4 w-full px-4 sm:px-6 lg:px-8 py-2 bg-white flex flex-wrap gap-2 justify-between items-center"
>
  <div class="text-sm text-gray-600">
    Exibindo {{ data.length }} de {{ totalItems }} {{ type === 'project' ? 'projetos' : 'coleções' }}
  </div>
  <div class="flex items-center gap-2">
    <ng-container *ngIf="currentPage > 1; else leftSpacer">
      <button aria-label="Página anterior" class="p-1 bg-none border-none cursor-pointer" (click)="previousPage()">
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none">
          <path d="M9.33333 11.6271L6.66666 8.96043L9.33333 6.29376" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </ng-container>
    <ng-template #leftSpacer>
      <div class="w-4 h-[17px]"></div>
    </ng-template>

    <div class="flex items-center gap-1">
      <div class="border border-gray-300 rounded-md px-2 py-1">
        <div class="text-sm text-gray-900">{{ currentPage }}</div>
      </div>
      <span class="text-sm text-gray-600">de {{ totalPages }} páginas</span>
    </div>

    <ng-container *ngIf="currentPage < totalPages; else rightSpacer">
      <button aria-label="Próxima página" class="p-1 bg-none border-none cursor-pointer" (click)="nextPage()">
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none">
          <path d="M6.66667 6.29376L9.33334 8.96043L6.66667 11.6271" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </ng-container>
    <ng-template #rightSpacer>
      <div class="w-4 h-[17px]"></div>
    </ng-template>
  </div>
</div>